<p id="notice"><%= notice %></p>
<div class="container">
  <div class="row">
    <% if user_signed_in? %>
      <h1 class="text-center">リスティング可変君</h1>
      <ul class="list-inline list-group">
        <li class="list-group-item">
          <a href="/">初期タグ</a>
        </li>
        <li class="list-group-item">
          <a href="/listings/registar">クリエイティブ登録</a>
        </li>
        <li class="list-group-item active">クリエイティブ編集</li>
        <li class="list-group-item">
          <a href="/listings/setting">セッティング</a>
        </li>
      </ul>
      <%= form_with(model: @listing, local: true) do |form| %>
      <div class="main-container">
        <div class="description">
          <p>編集したいクリエイティブを選択し、編集することが可能です。</p>
        </div>
        <div class="creative-name">
          <p>クリエイティブ名</p>
          <select name="creative" id="selector">
            <option value="#" selected="selected">選択してください</option>
            <% @listings.each do |listing| %>
              <% if listing.listing_user == current_user.user_id %>
                <option value="/listings/<%= listing.id %>/edit1"><%= listing.creative_name %></option>
              <% end %>
            <% end %>
          </select><br><br>
        </div>
        <%= form.text_area :listing_code, :size => "80x10", :class => "listing-code" %><br><br>
      </div>
    <% end %>
  <% end %>
</div>
</div>

<script type="text/javascript">
$(document).ready(function(){
  // 通常DOMがすべて読み込まれた後に実行
  $(document).on('click', '#selector', function() {
    var open = $(this).data("isopen");
    if (open) {
      window.location.href = $(this).val()
    }
    //set isopen to opposite so next time when use clicked select box it wont trigger this event
    $(this).data("isopen", !open);
  })
});
</script>
